<div class="container">
  <h1><%= @panel.panel_type.name %></h1>
  <p><strong>Estação:</strong> <%= @panel.station.name %></p>
  <% @panel.station.lines.each do |line| %>
    <p><%= line.name %></p>
  <% end %>

  <p>Area total: <%= @panel.panel_type.total_area %></p>
  <p>Area visivel: <%= @panel.panel_type.visible_area %></p>
  <p>Area de seguranca: <%= @panel.panel_type.security_area %></p>
  <p><%= humanized_money_with_symbol(@price) %> / mês</p>
  <%= link_to "back", panels_path %>

  <% if user_signed_in? %>
    <ul class="hidden">
      <% @dates.each do |date| %>
        <li class="dates" data-datefrom="<%= date[:from] %>" data-dateto="<%= date[:to] %>"></li>
      <% end %>
    </ul>
    <% if @companies.nil? || @companies.empty? %>
      <div class="text-center">
        <h4>
          Você precisa registrar sua empresa antes de adicionar painéis à sua campanha.
        </h4>
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target=".company-modal">Criar empresa</button>
      </div>
    <% elsif !@companies.nil? && @campaigns.empty? %>
      <h5>Você ainda não possui uma campanha</h5>
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target=".campaign-modal">Criar campanha</button>

    <% else %>
      <div class="row">
        <div class="col-md-4 col-md-offset-4">
          <%= simple_form_for [@panel, @order] do |f| %>
            <%= f.input :date, input_html: { class: "panel-date" } %>
            <%= f.association :campaign, collection: @campaigns %>
            <%= f.select :duration, collection: [28, 56, 84, 112, 140, 168, 196, 224, 252, 280, 308, 336, 364] %>
            <%= f.submit %>
          <% end %>
        </div>
      </div>
    <% end %>
  <% end %>
<div class="modal fade company-modal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <%= render template: "companies/new" %>
    </div>
  </div>
</div>

<div class="modal fade campaign-modal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="row">
        <div class="col-md-4 col-md-offset-4">
          <%= simple_form_for [@campaign] do |f| %>
            <%= f.select :company, @companies.map { |company| [company.name, company.id]} %>
            <%= f.input :title %>
            <%= f.submit "Criar campanha", class: "btn btn-primary" %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
</div>

